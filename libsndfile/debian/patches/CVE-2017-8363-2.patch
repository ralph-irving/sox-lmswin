Index: libsndfile-1.0.25/src/flac.c
===================================================================
--- libsndfile-1.0.25.orig/src/flac.c	2017-05-27 20:13:41.382287617 +0200
+++ libsndfile-1.0.25/src/flac.c	2017-05-27 20:13:41.374287140 +0200
@@ -828,7 +828,9 @@
 
 	psf_log_printf (psf, "End\n") ;
 
-	if (psf->error == 0)
+	if (psf->error != 0)
+		FLAC__stream_decoder_delete (pflac->fsd) ;
+	else
 	{	FLAC__uint64 position ;
 
 		FLAC__stream_decoder_get_decode_position (pflac->fsd, &position) ;
